<template>
<view class="debugger">
    <view class="weui-article__h1 weui-article__h1--debugger">微信小程序调试助手</view>
    <view class="weui-panel weui-panel_access">
        <view class="weui-panel__hd">页面信息</view>
        <view class="weui-panel__bd">
            <view class="weui-media-box weui-media-box_text" wx:if="{{appId}}">
                <view class="weui-media-box__title weui-media-box__title_in-text" bindtap="copy" data-copy-content="{{appId}}">AppID</view>
                <view class="weui-media-box__desc">{{appId}}</view>
            </view>
            <view class="weui-media-box weui-media-box_text">
                <view class="weui-media-box__title weui-media-box__title_in-text" bindtap="copy" data-copy-content="{{pageInfoUrl}}">{{pageInfo}}</view>
                <view class="weui-media-box__desc">
                    <textarea class="weui-textarea" disabled auto-height maxlength="-1" value="{{pageInfoUrl}}" />
                </view>
            </view>
        </view>
    </view>

    <view class="weui-panel weui-panel_access">
        <view class="weui-panel__hd">切换调试开关</view>
        <view class="weui-panel__bd">
            <view class="weui-btn-area">
                <button type="primary" bindtap="setEnableDebug" data-value="{{true}}">开启</button>
            </view>
            <view class="weui-btn-area">
                <button type="default" bindtap="setEnableDebug" data-value="{{false}}">关闭</button>
            </view>
        </view>
    </view>

    <view class="weui-panel weui-panel_access">
        <view class="weui-panel__hd">小程序的页面</view>
        <view class="weui-panel__bd">
            <view class="weui-cells__title">跳转到页面</view>
            <view class="weui-cells weui-cells_after-title">
                <view class="weui-cell">
                    <view class="weui-cell__bd">
                        <textarea type="text" auto-height maxlength="-1" placeholder="输入页面的路径, 例如: /pages/home/index" value="{{pageUrl}}" bindinput="changePageUrl">
                        </textarea>
                    </view>
                </view>

                <view class="weui-cell" wx:for="{{pageUrlParams}}" wx:key="{{index}}">
                    <view class="weui-cell__bd weui-cell__bd--param">
                        <textarea class="weui-cell__bd--param-input" auto-height maxlength="-1" type="text" placeholder="输入参数名" value="{{item.key}}" bindinput="changePageUrlParamKey" data-index="{{index}}"></textarea>
                        <text class="weui-cell__bd--param-equal">=</text>
                        <textarea class="weui-cell__bd--param-input" auto-height maxlength="-1" type="text" placeholder="输入参数值" value="{{item.value}}" bindinput="changePageUrlParamValue" data-index="{{index}}"></textarea>
                        <icon class="weui-cell__bd--param-remove" type="clear" size="20" bindtap="removePageUrlParam" data-index="{{index}}" />
                    </view>
                </view>
            </view>
        </view>
        <view class="weui-panel__ft">
            <view class="weui-btn-area">
                <button type="primary" bindtap="navigateToPage" disabled="{{!pageUrl}}">跳转</button>
            </view>
            <view class="weui-btn-area">
                <button type="default" bindtap="addPageUrlParams">添加参数</button>
            </view>
        </view>

        <view class="weui-panel__bd">
            <view class="weui-cells__title">分享出页面</view>
            <view class="weui-cells weui-cells_after-title">
                <view class="weui-cell">
                    <view class="weui-cell__bd">
                        <textarea type="text" auto-height maxlength="-1" placeholder="输入分享的标题" value="{{shareTitle}}" bindinput="changeShareTitle">
                        </textarea>
                    </view>
                </view>
                <view class="weui-cell">
                    <view class="weui-cell__bd">
                        <textarea type="text" auto-height maxlength="-1" placeholder="输入分享的图片" value="{{shareImageUrl}}" bindinput="changeShareImageUrl">
                        </textarea>
                    </view>
                </view>
            </view>
        </view>
        <view class="weui-panel__ft">
            <view class="weui-btn-area">
                <button type="primary" open-type="share" bindtap="triggerShare" disabled="{{!pageUrl}}">分享(点击两次生效)</button>
            </view>
        </view>

        <view class="weui-panel__bd">
            <view class="weui-cells__title" bindtap="copy" data-copy-content="{{scanCodeResult}}">扫一扫</view>
            <view class="weui-media-box weui-media-box_text" wx:if="{{scanCodeResult}}">
                <view class="weui-media-box__desc">
                    <textarea class="weui-textarea" placeholder="扫一扫的结果" disabled auto-height maxlength="-1" value="{{scanCodeResult}}" />
                </view>
            </view>
        </view>
        <view class="weui-panel__ft">
            <view class="weui-btn-area">
                <button type="primary" bindtap="scanCode">扫一扫</button>
            </view>
        </view>
    </view>

    <view class="weui-panel weui-panel_access">
        <view class="weui-panel__hd">替换接口路径(Match API URL)</view>
        <view class="weui-panel__bd">
            <view class="weui-cells__title">类似 Fiddler 的 AutoResponder 或 Charles 的 Rewrite 功能</view>
            <view class="weui-cells weui-cells_after-title {{matchRulesSwitch ? '' : 'disabled-state'}}">
                <view class="weui-cell" wx:for="{{matchRules}}" wx:key="matchUrl">
                    <icon class="icon-remove" type="clear" size="20" bindtap="removeMatchRule" data-index="{{index}}"></icon>
                    <view class="weui-cell__bd">
                        <view bindtap="toggleRuleDisable" data-index="{{index}}">
                            <icon class="weui-icon-checkbox_circle" type="circle" size="23" wx:if="{{item.disabled}}"></icon>
                            <icon class="weui-icon-checkbox_success" type="success" size="23" wx:elif="{{!matchRulesSwitch && !item.disabled}}" color="#aaa"></icon>
                            <icon class="weui-icon-checkbox_success" type="success" size="23" wx:else></icon>
                            <text>规则{{index + 1}}</text>
                        </view>
                        <view class="match-rule-input-box {{item.disabled || !matchRulesSwitch ? 'disabled-state' : ''}}">
                            <textarea auto-height maxlength="-1" type="text" placeholder="匹配的 URL, 例如: https://i.a.cn/b/user" disabled="{{item.disabled}}" value="{{item.matchUrl}}" bindinput="changeMatchUrl" data-index="{{index}}"></textarea>
                            <view>↓</view>
                            <textarea auto-height maxlength="-1" type="text" placeholder="替换成 URL, 例如: https://b.cn/user" disabled="{{item.disabled}}" value="{{item.replaceUrl}}" bindinput="changeReplaceUrl" data-index="{{index}}"></textarea>
                        </view>
                    </view>
                </view>
            </view>
        </view>
        <view class="weui-panel__ft">
            <view class="weui-btn-area">
                <button type="{{matchRulesSwitch ? 'default' : 'primary'}}" bindtap="toggleMatchRules">{{matchRulesSwitch ? '关闭替换' : '开启替换'}}</button>
            </view>
            <view class="weui-btn-area">
                <button type="default" bindtap="addMatchRule">新增规则</button>
            </view>
        </view>
    </view>

    <view class="weui-panel weui-panel_access">
        <view class="weui-panel__hd">获取小程序本地数据缓存</view>
        <view class="weui-panel__bd" wx:if="{{storage}}">
            <view class="weui-cells weui-cells_after-title">
                <view class="weui-cell">
                    <view class="weui-cell__bd">当前占用</view>
                    <view class="weui-cell__ft">{{storage.currentSize}} KB</view>
                </view>
                <view class="weui-cell">
                    <view class="weui-cell__bd">限制空间</view>
                    <view class="weui-cell__ft">{{storage.limitSize}} KB</view>
                </view>
            </view>
            <view class="weui-media-box weui-media-box_text" wx:for="{{storage.item}}" wx:key="key">
                <icon class="icon-remove" type="clear" size="20" bindtap="removeStorageItem" data-storage-key="{{item.key}}" data-storage-content="{{item.key}}: {{item.valueString}}"></icon>
                <view class="weui-media-box__title weui-media-box__title_in-text" bindtap="copy" data-copy-content="{{item.key}}: {{item.valueString}}">{{item.key}}</view>
                <view class="weui-media-box__desc">
                    <textarea class="weui-textarea" auto-height maxlength="-1" value="{{item.valueString}}" bindconfirm="changeStorageItem" data-storage-key="{{item.key}}" />
                </view>
            </view>
        </view>
        <view class="weui-panel__ft">
            <view class="weui-btn-area">
                <button type="primary" bindtap="getStorage">获取</button>
            </view>
        </view>
    </view>

    <view class="weui-panel weui-panel_access">
        <view class="weui-panel__hd" bindtap="copy" data-copy-content="{{loginCodeResult}}">获取微信小程序登录凭证(code)</view>
        <view class="weui-panel__bd">
            <view class="weui-media-box weui-media-box_text" wx:if="{{loginCodeResult}}">
                <view class="weui-media-box__desc">
                    <textarea class="weui-textarea" disabled auto-height maxlength="-1" placeholder="小程序登录凭证" value="{{loginCodeResult}}" />
                </view>
            </view>
        </view>
        <view class="weui-panel__ft">
            <view class="weui-btn-area">
                <button type="primary" bindtap="getLoginCode">获取</button>
            </view>
        </view>
    </view>

    <view class="weui-panel weui-panel_access">
        <view class="weui-panel__hd" bindtap="copy" data-copy-content="{{weappAccountInfo}}">获取当前小程序帐号信息</view>
        <view class="weui-panel__bd">
            <view class="weui-media-box weui-media-box_text" wx:if="{{weappAccountInfo}}">
                <view class="weui-media-box__desc">
                    <textarea class="weui-textarea" disabled auto-height maxlength="-1" placeholder="小程序帐号信息" value="{{weappAccountInfo}}" />
                </view>
            </view>
        </view>
        <view class="weui-panel__ft">
            <view class="weui-btn-area">
                <button type="primary" bindtap="getWeappAccountInfo">获取</button>
            </view>
        </view>
    </view>

    <view class="weui-panel weui-panel_access">
        <view class="weui-panel__hd" bindtap="copy" data-copy-content="{{deviceInfo}}">设备信息</view>
        <view class="weui-panel__bd">
            <view class="weui-media-box weui-media-box_text">
                <view class="weui-media-box__desc">
                    <textarea class="weui-textarea" disabled auto-height maxlength="-1" value="{{deviceInfo}}" />
                </view>
            </view>
        </view>
    </view>

    <view class="weui-footer">
        <view class="weui-footer__text">v1.0.0 github.com/ufologist/weapp-component-debugger</view>
    </view>
</view>
</template>
<script>
import {
    navigateTo,
    appendUrl
} from 'weapp-commons-util';

const DEBUGGER_MATCH_RULES_KEY = '_debugger-match-rules';
const DEBUGGER_MATCH_RULE_SWITCH_KEY = '_debugger-match-rules-switch';

export default {
    data: {
        appId: '',
        pageInfo: '',
        pageInfoUrl: '',
        deviceInfo: '',

        // [{matchUrl: 'https://api.domain.com/b/login', replaceUrl: 'https://domain.com/login', disabled: false}]
        matchRules: [],
        matchRulesSwitch: false,

        scanCodeResult: '',
        weappAccountInfo: '',
        loginCodeResult: '',
        storage: null,

        pageUrl: '',
        // [{key: 'key1', value: 'value1'}, {key: 'key2', value: 'value2'}]
        pageUrlParams: [],
        pageUrlWithParams: ''
    },
    created: function() {
        this.backupWxApi('request');
        this.backupWxApi('uploadFile');
        this.backupWxApi('downloadFile');
    },
    attached: function() {
        this.init();
    },
    pageLifetimes: {
        show: function() {
            this.init();
        }
    },
    methods: {
        init: function() {
            this.getAppId();
            this.initDeviceInfo();
            this.initPageInfo();
            this.initMatchRules();
            this.initMatchRulesSwitch();
            this.changeMatchRules(this.data.matchRulesSwitch);
        },

        copy: function(event) {
            var copyContent = event.currentTarget.dataset.copyContent;
            if (copyContent) {
                wx.setClipboardData({
                    data: copyContent
                });
            }
        },

        initDeviceInfo: function() {
            var getNetworkType = new Promise(function(resolve, reject) {
                wx.getNetworkType({
                    success: (result) => {
                        resolve(result);
                    },
                    fail: (result) => {
                        resolve(result);
                    }
                });
            });

            var getConnectedWifi = new Promise(function(resolve, reject) {
                wx.getConnectedWifi({
                    success: (result) => {
                        resolve(result);
                    },
                    fail: (result) => {
                        resolve(result);
                    }
                });
            });

            var getSystemInfo = new Promise(function(resolve, reject) {
                wx.getSystemInfo({
                    success: (result) => {
                        resolve(result);
                    },
                    fail: (result) => {
                        resolve(result);
                    }
                });
            });

            Promise.all([getNetworkType, getConnectedWifi, getSystemInfo])
                .then(([networkType, connectedWifi, systemInfo]) => {
                        var deviceInfo = {
                            networkType: networkType,
                            connectedWifi: connectedWifi,
                            systemInfo: systemInfo
                        };

                        this.setData({
                            deviceInfo: JSON.stringify(deviceInfo, null, 4)
                        });
                });
        },
        initPageInfo: function() {
            var pages = getCurrentPages();
            var page = null;

            if (pages) {
                if (pages.length >= 2) { // 上一个页面的信息
                    page = pages[pages.length - 2];
                    this.setData({
                        pageInfo: '上一个页面的 URL'
                    });
                } else { // 当前页面的信息
                    page = pages[pages.length - 1];
                    this.setData({
                        pageInfo: '当前页面的 URL'
                    });
                }
            }

            if (page) {
                this.setData({
                    pageInfoUrl: appendUrl(`/${page.route}`, page.options)
                });
            }
        },

        toggleMatchRules: function() {
            this.changeMatchRules(!this.data.matchRulesSwitch);
        },
        changeMatchRules: function(matchRulesSwitch) {
            if (matchRulesSwitch) { // 开启
                // 重写 wx.request/uploadFile/downloadFile
                this.overwriteWxNetwork('request');
                this.overwriteWxNetwork('uploadFile');
                this.overwriteWxNetwork('downloadFile');
            } else {
                // 恢复 wx.request/uploadFile/downloadFile
                this.restoreWxApi('request');
                this.restoreWxApi('uploadFile');
                this.restoreWxApi('downloadFile');
            }

            this.saveMatchRulesSwitch(matchRulesSwitch);
        },
        addMatchRule: function() {
            var matchRules = this.data.matchRules;
            matchRules.push({
                matchUrl: '',
                replaceUrl: ''
            });
            this.setData({
                matchRules: matchRules
            });
        },
        changeMatchUrl: function(event) {
            var index = event.currentTarget.dataset.index;
            var newMatchUrl = event.detail.value;
            this.changeRuleField(index, 'matchUrl', newMatchUrl);
        },
        changeReplaceUrl: function(event) {
            var index = event.currentTarget.dataset.index;
            var newReplaceUrl = event.detail.value;
            this.changeRuleField(index, 'replaceUrl', newReplaceUrl);
        },
        toggleRuleDisable: function(event) {
            var index = event.currentTarget.dataset.index;
            var matchRule = this.data.matchRules[index];
            this.changeRuleField(index, 'disabled', !matchRule.disabled);
        },
        changeRuleField: function(index, filedName, value) {
            var matchRules = this.data.matchRules;
            var rule = matchRules[index];
            rule[filedName] = value;

            this.saveMatchRules(matchRules);
        },
        initMatchRulesSwitch: function() {
            try {
                var matchRulesSwitch = wx.getStorageSync(DEBUGGER_MATCH_RULE_SWITCH_KEY);
                this.setData({
                    matchRulesSwitch: matchRulesSwitch
                });
            } catch (error) {
                console.error(error);
                wx.showModal({
                    title: '获取启用替换开关失败',
                    content: error.message
                });
            }
        },
        saveMatchRulesSwitch: function(matchRulesSwitch) {
            this.setData({
                matchRulesSwitch: matchRulesSwitch
            });

            try {
                wx.setStorageSync(DEBUGGER_MATCH_RULE_SWITCH_KEY, matchRulesSwitch);
            } catch (error) {
                console.error(error);
                wx.showModal({
                    title: '保存启用替换开关失败',
                    content: error.message
                });
            }
        },
        getMatchRules: function() {
            var matchRules = [];
            try {
                matchRules = wx.getStorageSync(DEBUGGER_MATCH_RULES_KEY);
                if (!matchRules) {
                    matchRules = [];
                }
            } catch (error) {
                console.error(error);
                wx.showModal({
                    title: '获取替换接口路径失败',
                    content: error.message
                });
            }
            return matchRules;
        },
        initMatchRules: function() {
            var matchRules = this.getMatchRules();
            this.setData({
                matchRules: matchRules
            });
        },
        saveMatchRules: function(matchRules) {
            this.setData({
                matchRules: matchRules
            });

            try {
                wx.setStorageSync(DEBUGGER_MATCH_RULES_KEY, matchRules);
            } catch (error) {
                wx.showModal({
                    title: '保存替换接口路径失败',
                    content: error
                });
            }
        },
        removeMatchRule: function(event) {
            var index = event.currentTarget.dataset.index;
            var matchRules = this.data.matchRules;
            var rule = matchRules[index];

            wx.showModal({
                title: `删除规则${index + 1}?`,
                content: JSON.stringify(rule, null, 4),
                success: (result) => {
                    if (result.confirm) {
                        matchRules.splice(index, 1);
                        this.saveMatchRules(matchRules);
                    }
                }
            });
        },
        backupWxApi: function(apiName) {
            var newApiName = '_' + apiName;
            if (!wx[newApiName]) {
                var wxApi = wx[apiName];

                Object.defineProperty(wx, newApiName, {
                    value: wxApi,
                    writable: true,
                    configurable: true
                });
            }
        },
        restoreWxApi: function(apiName) {
            var wxApi = wx['_' + apiName];

            Object.defineProperty(wx, apiName, {
                value: wxApi,
                writable: true,
                configurable: true
            });

            console.log('-----------------');
            console.log(`恢复 wx.${apiName}`);
            console.log('-----------------');
        },
        overwriteWxNetwork: function(apiName) {
            var wxNetwork = wx[apiName];

            console.log('-----------------');
            console.log(`重写 wx.${apiName}`);
            console.log('-----------------');

            Object.defineProperty(wx, apiName, {
                writable: true,
                configurable: true,
                value: (options) => {
                    try {
                        var matchRules = this.getMatchRules();
                        var rule = matchRules.filter(function(rule) {
                            return !rule.disabled && options.url.indexOf(rule.matchUrl) !== -1;
                        }).sort(function(rule1, rule2) { // 优先匹配最长的规则
                            var matchUrl1Length = rule1.matchUrl.length;
                            var matchUrl2Length = rule2.matchUrl.length;

                            if (matchUrl1Length < matchUrl2Length) {
                                return -1;
                            } else if (matchUrl1Length > matchUrl2Length) {
                                return 1;
                            } else {
                                return 0;
                            }
                        }).reverse()[0];

                        if (options.url && rule) {
                            options.url = options.url.replace(rule.matchUrl, rule.replaceUrl);

                            // 在 URL 中添加标识, 可以快速识别出这个请求是被调试的
                            var matchRuleNumber = matchRules.indexOf(rule) + 1;
                            if (options.url.indexOf('?') === -1) {
                                options.url = `${options.url}?_debug=${matchRuleNumber}`;
                            } else {
                                options.url = `${options.url}&_debug=${matchRuleNumber}`;
                            }
                        }

                        var logComplete = function(requestOptions, requestResult) {
                            console.log(`[wx.${apiName}]`,
                                        requestOptions.method, requestOptions.url, requestOptions.data,
                                        requestOptions, requestResult);
                            console.log('----------------------');
                        };
                        var originalComplete = options.complete;
                        if (originalComplete) {
                            options.complete = function(requestResult) {
                                originalComplete(requestResult);
                                logComplete(options, requestResult);
                            };
                        } else {
                            options.complete = function(requestResult) {
                                logComplete(options, requestResult);
                            };
                        }
                    } catch (error) {
                        console.error('overwriteWxNetwork', error);
                        wx.showModal({
                            title: '获取替换接口路径失败',
                            content: error.message,
                            showCancel: false
                        });
                    }

                    return wxNetwork.call(wx, options);
                }
            });
        },

        scanCode: function() {
            wx.scanCode({
                success: (result) => {
                    wx.showToast({
                        icon: 'success',
                        title: '扫码成功'
                    });
                    this.setData({
                        scanCodeResult: JSON.stringify(result, null, 4)
                    });
                    wx.setClipboardData({
                        data: this.data.scanCodeResult
                    });

                    if (result.path) {
                        var path = result.path;
                        // 需要用绝对路径
                        if (path.indexOf('/') !== 0) {
                            path = '/' + path;
                        }

                        wx.showModal({
                            title: '跳转到小程序的页面?',
                            content: `页面路径: ${path}`,
                            success: (modalResult) => {
                                if (modalResult.confirm) {
                                    navigateTo({
                                        url: path
                                    });
                                }
                            }
                        });
                    }
                },
                fail: (result) => {
                    wx.showToast({
                        icon: 'none',
                        title: result.errMsg
                    });
                    this.setData({
                        scanCodeResult: JSON.stringify(result, null, 4)
                    });
                }
            });
        },

        getAppId: function() {
            if (wx.getAccountInfoSync) {
                this.setData({
                    appId: wx.getAccountInfoSync().miniProgram.appId
                });
            }
        },
        getWeappAccountInfo: function() {
            if (wx.getAccountInfoSync) {
                this.setData({
                    weappAccountInfo: JSON.stringify(wx.getAccountInfoSync(), null, 4)
                });
                wx.setClipboardData({
                    data: this.data.weappAccountInfo
                });
            } else {
                wx.showToast({
                    icon: 'none',
                    title: '获取当前小程序帐号信息\n需要基础库 >= 2.2.2'
                });
            }
        },

        setEnableDebug: function(event) {
            wx.setEnableDebug({
                enableDebug: event.currentTarget.dataset.value
            });
        },

        getLoginCode: function() {
            wx.login({
                success: (result) => {
                    this.setData({
                        loginCodeResult: JSON.stringify(result, null, 4)
                    });
                    wx.setClipboardData({
                        data: result.code
                    });
                }
            });
        },

        getStorage: function() {
            var result = wx.getStorageInfoSync();
            result.item = [];
            result.keys.forEach(function(key) {
                var value = wx.getStorageSync(key);
                result.item.push({
                    key: key,
                    value: value,
                    valueString: JSON.stringify(value, null, 4)
                });
            });

            this.setData({
                storage: result
            });
        },
        removeStorageItem: function(event) {
            wx.showModal({
                title: '想删除这个缓存数据吗?',
                content: event.currentTarget.dataset.storageContent,
                success: (result) => {
                    if (result.confirm) {
                        wx.removeStorage({
                            key: event.currentTarget.dataset.storageKey,
                            success: () => {
                                this.getStorage();
                            }
                        });
                    }
                }
            });
        },
        changeStorageItem: function(event) {
            var storageKey = event.currentTarget.dataset.storageKey;
            var value = event.detail.value;

            wx.setStorage({
                key: storageKey,
                data: JSON.parse(value),
                success: () => {
                    wx.showToast({
                        icon: 'success',
                        title: '修改成功'
                    });
                    this.getStorage();
                }
            });
        },

        changePageUrl: function(event) {
            this.setData({
                pageUrl: event.detail.value
            });
        },
        addPageUrlParams: function() {
            var pageUrlParams = this.data.pageUrlParams;
            pageUrlParams.push({
                key: '',
                value: ''
            });
            this.setData({
                pageUrlParams: pageUrlParams
            });
        },
        changePageUrlParamKey: function(event) {
            var index = event.currentTarget.dataset.index;
            var newKey = event.detail.value;

            var pageUrlParams = this.data.pageUrlParams;
            var kv = pageUrlParams[index];
            kv.key = newKey;

            this.setData({
                pageUrlParams: pageUrlParams
            });
        },
        changePageUrlParamValue: function(event) {
            var index = event.currentTarget.dataset.index;
            var newValue = event.detail.value;

            var pageUrlParams = this.data.pageUrlParams;
            var kv = pageUrlParams[index];
            kv.value = newValue;

            this.setData({
                pageUrlParams: pageUrlParams
            });
        },
        removePageUrlParam: function(event) {
            var index = event.currentTarget.dataset.index;

            var pageUrlParams = this.data.pageUrlParams;
            pageUrlParams.splice(index, 1);

            this.setData({
                pageUrlParams: pageUrlParams
            });
        },
        navigateToPage: function() {
            var urlParams = this.data.pageUrlParams.reduce(function(prev, item) {
                if (item.key) {
                    prev[item.key] = item.value;
                }
                return prev;
            }, {});

            this.setData({
                pageUrlWithParams: appendUrl(this.data.pageUrl, urlParams)
            });
            wx.setClipboardData({
                data: this.data.pageUrlWithParams
            });

            wx.showModal({
                title: '确认跳转到小程序的页面',
                content: this.data.pageUrlWithParams,
                success: (result) => {
                    if (result.confirm) {
                        navigateTo({
                            url: this.data.pageUrl,
                            _urlParams: urlParams,
                            fail: function(result) {
                                wx.showModal({
                                    title: '跳转失败',
                                    content: result.errMsg,
                                    showCancel: false
                                });
                            }
                        });
                    }
                }
            });
        },
        changeShareTitle: function(event) {
            this.setData({
                shareTitle: event.detail.value
            });
        },
        changeShareImageUrl: function(event) {
            this.setData({
                shareImageUrl: event.detail.value
            });
        },
        triggerShare: function() {
            // 由于无法通过 API 来触发分享功能, 只能通知页面修改分享的数据
            // 因此会先唤起分享, 再实际修改分享的数据
            // 想要分享的内容生效, 需要点击两次分享
            this.triggerEvent('share', {
                title: this.data.shareTitle ? this.data.shareTitle : '',
                path: this.data.pageUrl ? this.data.pageUrl : '',
                imageUrl: this.data.shareImageUrl ? this.data.shareImageUrl : ''
            });
        }
    }
};
</script>
<style lang="less">
/*!
 * WeUI v1.1.1 (https://github.com/weui/weui-wxss)
 * Copyright 2017 Tencent, Inc.
 * Licensed under the MIT license
 */
page {
    line-height: 1.6;
    font-family: -apple-system-font, Helvetica Neue, sans-serif
}

icon {
    vertical-align: middle
}

.weui-cells {
    position: relative;
    margin-top: 1.17647059em;
    background-color: #fff;
    line-height: 1.41176471;
    font-size: 17PX
}

.weui-cells:before {
    top: 0;
    border-top: 1rpx solid #d9d9d9
}

.weui-cells:after,
.weui-cells:before {
    content: " ";
    position: absolute;
    left: 0;
    right: 0;
    height: 1PX;
    color: #d9d9d9
}

.weui-cells:after {
    bottom: 0;
    border-bottom: 1rpx solid #d9d9d9
}

.weui-cells__title {
    margin-top: .77em;
    margin-bottom: .3em;
    padding-left: 15PX;
    padding-right: 15PX;
    color: #999;
    font-size: 14PX
}

.weui-cells_after-title {
    margin-top: 0
}

.weui-cells__tips {
    margin-top: .3em;
    color: #999;
    padding-left: 15PX;
    padding-right: 15PX;
    font-size: 14PX
}

.weui-cell {
    padding: 10PX 15PX;
    position: relative;
    display: -webkit-box;
    display: -webkit-flex;
    display: flex;
    -webkit-box-align: center;
    -webkit-align-items: center;
    align-items: center
}

.weui-cell:before {
    content: " ";
    position: absolute;
    left: 0;
    top: 0;
    right: 0;
    height: 1PX;
    border-top: 1rpx solid #d9d9d9;
    color: #d9d9d9;
    left: 15PX
}

.weui-cell:first-child:before {
    display: none
}

.weui-cell_active {
    background-color: #ececec
}

.weui-cell_primary {
    -webkit-box-align: start;
    -webkit-align-items: flex-start;
    align-items: flex-start
}

.weui-cell__bd {
    -webkit-box-flex: 1;
    -webkit-flex: 1;
    flex: 1
}

.weui-cell__ft {
    text-align: right;
    color: #999
}

.weui-cell_access {
    color: inherit
}

.weui-cell__ft_in-access {
    padding-right: 13PX;
    position: relative
}

.weui-cell__ft_in-access:after {
    content: " ";
    display: inline-block;
    height: 6PX;
    width: 6PX;
    border-width: 2PX 2PX 0 0;
    border-color: #c8c8cd;
    border-style: solid;
    -webkit-transform: matrix(.71, .71, -.71, .71, 0, 0);
    transform: matrix(.71, .71, -.71, .71, 0, 0);
    position: relative;
    top: -2PX;
    position: absolute;
    top: 50%;
    margin-top: -4PX;
    right: 2PX
}

.weui-cell_link {
    color: #586c94;
    font-size: 14PX
}

.weui-cell_link:active {
    background-color: #ececec
}

.weui-cell_link:first-child:before {
    display: block
}

.weui-icon-radio {
    margin-left: 3.2PX;
    margin-right: 3.2PX
}

.weui-icon-checkbox_circle,
.weui-icon-checkbox_success {
    margin-left: 4.6PX;
    margin-right: 4.6PX
}

.weui-check__label:active {
    background-color: #ececec
}

.weui-check {
    position: absolute;
    left: -9999PX
}

.weui-check__hd_in-checkbox {
    padding-right: .35em
}

.weui-cell__ft_in-radio {
    padding-left: .35em
}

.weui-cell_input {
    padding-top: 0;
    padding-bottom: 0
}

.weui-label {
    width: 105PX;
    word-wrap: break-word;
    word-break: break-all
}

.weui-input {
    height: 2.58823529em;
    min-height: 2.58823529em;
    line-height: 2.58823529em
}

.weui-toptips {
    position: fixed;
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
    top: 0;
    left: 0;
    right: 0;
    padding: 5PX;
    font-size: 14PX;
    text-align: center;
    color: #fff;
    z-index: 5000;
    word-wrap: break-word;
    word-break: break-all
}

.weui-toptips_warn {
    background-color: #e64340
}

.weui-textarea {
    display: block;
    width: 100%
}

.weui-textarea-counter {
    color: #b2b2b2;
    text-align: right
}

.weui-cell_warn,
.weui-textarea-counter_warn {
    color: #e64340
}

.weui-form-preview {
    position: relative;
    background-color: #fff
}

.weui-form-preview:before {
    top: 0;
    border-top: 1rpx solid #d9d9d9
}

.weui-form-preview:after,
.weui-form-preview:before {
    content: " ";
    position: absolute;
    left: 0;
    right: 0;
    height: 1PX;
    color: #d9d9d9
}

.weui-form-preview:after {
    bottom: 0;
    border-bottom: 1rpx solid #d9d9d9
}

.weui-form-preview__value {
    font-size: 14PX
}

.weui-form-preview__value--gray {
    color: #848C99 !important;
}

.weui-form-preview__value_in-hd {
    font-size: 26PX
}

.weui-form-preview__hd {
    position: relative;
    padding: 10PX 15PX;
    text-align: right;
    line-height: 2.5em
}

.weui-form-preview__hd:after {
    content: " ";
    position: absolute;
    left: 0;
    bottom: 0;
    right: 0;
    height: 1PX;
    border-bottom: 1rpx solid #d9d9d9;
    color: #d9d9d9;
    left: 15PX
}

.weui-form-preview__bd {
    padding: 10PX 15PX;
    font-size: .9em;
    text-align: right;
    color: #999;
    line-height: 2
}

.weui-form-preview__ft {
    position: relative;
    line-height: 50PX;
    display: -webkit-box;
    display: -webkit-flex;
    display: flex
}

.weui-form-preview__ft:after {
    content: " ";
    position: absolute;
    left: 0;
    top: 0;
    right: 0;
    height: 1PX;
    border-top: 1rpx solid #d5d5d6;
    color: #d5d5d6
}

.weui-form-preview__item {
    overflow: hidden
}

.weui-form-preview__label {
    float: left;
    margin-right: 1em;
    min-width: 4em;
    color: #999;
    text-align: justify;
    text-align-last: justify
}

.weui-form-preview__value {
    display: block;
    overflow: hidden;
    word-break: normal;
    word-wrap: break-word
}

.weui-form-preview__btn {
    position: relative;
    display: block;
    -webkit-box-flex: 1;
    -webkit-flex: 1;
    flex: 1;
    color: #3cc51f;
    text-align: center
}

.weui-form-preview__btn:after {
    content: " ";
    position: absolute;
    left: 0;
    top: 0;
    width: 1PX;
    bottom: 0;
    border-left: 1rpx solid #d5d5d6;
    color: #d5d5d6
}

.weui-form-preview__btn:first-child:after {
    display: none
}

.weui-form-preview__btn_active {
    background-color: #eee
}

.weui-form-preview__btn_default {
    color: #999
}

.weui-form-preview__btn_primary {
    color: #0bb20c
}

.weui-cell_select {
    padding: 0
}

.weui-select {
    position: relative;
    padding-left: 15PX;
    padding-right: 30PX;
    height: 2.58823529em;
    min-height: 2.58823529em;
    line-height: 2.58823529em;
    border-right: 1rpx solid #d9d9d9
}

.weui-select:before {
    content: " ";
    display: inline-block;
    height: 6PX;
    width: 6PX;
    border-width: 2PX 2PX 0 0;
    border-color: #c8c8cd;
    border-style: solid;
    -webkit-transform: matrix(.71, .71, -.71, .71, 0, 0);
    transform: matrix(.71, .71, -.71, .71, 0, 0);
    position: relative;
    top: -2PX;
    position: absolute;
    top: 50%;
    right: 15PX;
    margin-top: -4PX
}

.weui-select_in-select-after {
    padding-left: 0
}

.weui-cell__bd_in-select-before,
.weui-cell__hd_in-select-after {
    padding-left: 15PX
}

.weui-cell_vcode {
    padding-right: 0
}

.weui-vcode-btn,
.weui-vcode-img {
    margin-left: 5PX;
    height: 2.58823529em;
    vertical-align: middle
}

.weui-vcode-btn {
    display: inline-block;
    padding: 0 .6em 0 .7em;
    border-left: 1PX solid #e5e5e5;
    line-height: 2.58823529em;
    font-size: 17PX;
    color: #3cc51f;
    white-space: nowrap
}

.weui-vcode-btn:active {
    color: #52a341
}

.weui-cell_switch {
    padding-top: 6PX;
    padding-bottom: 6PX
}

.weui-uploader__hd {
    display: -webkit-box;
    display: -webkit-flex;
    display: flex;
    padding-bottom: 10PX;
    -webkit-box-align: center;
    -webkit-align-items: center;
    align-items: center
}

.weui-uploader__title {
    -webkit-box-flex: 1;
    -webkit-flex: 1;
    flex: 1
}

.weui-uploader__info {
    color: #b2b2b2
}

.weui-uploader__bd {
    margin-bottom: -4PX;
    margin-right: -9PX;
    overflow: hidden
}

.weui-uploader__file {
    float: left;
    margin-right: 9PX;
    margin-bottom: 9PX
}

.weui-uploader__img {
    display: block;
    width: 79PX;
    height: 79PX
}

.weui-uploader__file_status {
    position: relative
}

.weui-uploader__file_status:before {
    content: " ";
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    background-color: rgba(0, 0, 0, .5)
}

.weui-uploader__file-content {
    position: absolute;
    top: 50%;
    left: 50%;
    -webkit-transform: translate(-50%, -50%);
    transform: translate(-50%, -50%);
    color: #fff
}

.weui-uploader__input-box {
    float: left;
    position: relative;
    margin-right: 9PX;
    margin-bottom: 9PX;
    width: 77PX;
    height: 77PX;
    border: 1PX solid #d9d9d9
}

.weui-uploader__input-box:after,
.weui-uploader__input-box:before {
    content: " ";
    position: absolute;
    top: 50%;
    left: 50%;
    -webkit-transform: translate(-50%, -50%);
    transform: translate(-50%, -50%);
    background-color: #d9d9d9
}

.weui-uploader__input-box:before {
    width: 2PX;
    height: 39.5PX
}

.weui-uploader__input-box:after {
    width: 39.5PX;
    height: 2PX
}

.weui-uploader__input-box:active {
    border-color: #999
}

.weui-uploader__input-box:active:after,
.weui-uploader__input-box:active:before {
    background-color: #999
}

.weui-uploader__input {
    position: absolute;
    z-index: 1;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0
}

.weui-article {
    padding: 20PX 15PX;
    font-size: 15PX
}

.weui-article__section {
    margin-bottom: 1.5em
}

.weui-article__h1 {
    font-size: 18PX;
    font-weight: 400;
    margin-bottom: .9em
}

.weui-article__h2 {
    font-size: 16PX;
    font-weight: 400;
    margin-bottom: .34em
}

.weui-article__h3 {
    font-weight: 400;
    font-size: 15PX;
    margin-bottom: .34em
}

.weui-article__p {
    margin: 0 0 .8em
}

.weui-msg {
    padding-top: 36PX;
    text-align: center
}

.weui-msg__link {
    display: inline;
    color: #586c94
}

.weui-msg__icon-area {
    margin-bottom: 30PX
}

.weui-msg__text-area {
    margin-bottom: 25PX;
    padding: 0 20PX
}

.weui-msg__title {
    margin-bottom: 5PX;
    font-weight: 400;
    font-size: 20PX
}

.weui-msg__desc {
    font-size: 14PX;
    color: #999
}

.weui-msg__opr-area {
    margin-bottom: 25PX
}

.weui-msg__extra-area {
    margin-bottom: 15PX;
    font-size: 14PX;
    color: #999
}

@media screen and (min-height:438PX) {
    .weui-msg__extra-area {
        position: fixed;
        left: 0;
        bottom: 0;
        width: 100%;
        text-align: center
    }
}

.weui-flex {
    display: -webkit-box;
    display: -webkit-flex;
    display: flex
}

.weui-flex__item {
    -webkit-box-flex: 1;
    -webkit-flex: 1;
    flex: 1
}

.weui-btn {
    margin-top: 15PX
}

.weui-btn:first-child {
    margin-top: 0
}

.weui-btn-area {
    margin: 1.17647059em 15PX .3em
}

.weui-agree {
    display: block;
    padding: .5em 15PX;
    font-size: 13PX
}

.weui-agree__text {
    color: #999
}

.weui-agree__link {
    display: inline;
    color: #586c94
}

.weui-agree__checkbox {
    position: absolute;
    left: -9999PX
}

.weui-agree__checkbox-icon {
    position: relative;
    top: 2PX;
    display: inline-block;
    border: 1PX solid #d1d1d1;
    background-color: #fff;
    border-radius: 3PX;
    width: 11PX;
    height: 11PX
}

.weui-agree__checkbox-icon-check {
    position: absolute;
    top: 1PX;
    left: 1PX
}

.weui-footer {
    color: #999;
    font-size: 14PX;
    text-align: center
}

.weui-footer_fixed-bottom {
    position: fixed;
    bottom: .52em;
    left: 0;
    right: 0
}

.weui-footer__links {
    font-size: 0
}

.weui-footer__link {
    display: inline-block;
    vertical-align: top;
    margin: 0 .62em;
    position: relative;
    font-size: 14PX;
    color: #586c94
}

.weui-footer__link:before {
    content: " ";
    position: absolute;
    left: 0;
    top: 0;
    width: 1PX;
    bottom: 0;
    border-left: 1rpx solid #c7c7c7;
    color: #c7c7c7;
    left: -.65em;
    top: .36em;
    bottom: .36em
}

.weui-footer__link:first-child:before {
    display: none
}

.weui-footer__text {
    padding: 0 .34em;
    font-size: 12PX
}

.weui-grids {
    border-top: 1rpx solid #d9d9d9;
    border-left: 1rpx solid #d9d9d9;
    overflow: hidden
}

.weui-grid {
    position: relative;
    float: left;
    padding: 20PX 10PX;
    width: 33.33333333%;
    box-sizing: border-box;
    border-right: 1rpx solid #d9d9d9;
    border-bottom: 1rpx solid #d9d9d9
}

.weui-grid_active {
    background-color: #ececec
}

.weui-grid__icon {
    display: block;
    width: 28PX;
    height: 28PX;
    margin: 0 auto
}

.weui-grid__label {
    margin-top: 5PX;
    display: block;
    text-align: center;
    color: #000;
    font-size: 14PX;
    white-space: nowrap;
    text-overflow: ellipsis;
    overflow: hidden
}

.weui-loading {
    margin: 0 5PX;
    width: 20PX;
    height: 20PX;
    display: inline-block;
    vertical-align: middle;
    -webkit-animation: a 1s steps(12) infinite;
    animation: a 1s steps(12) infinite;
    background: transparent url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAiIGhlaWdodD0iMTIwIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCI+PHBhdGggZmlsbD0ibm9uZSIgZD0iTTAgMGgxMDB2MTAwSDB6Ii8+PHJlY3Qgd2lkdGg9IjciIGhlaWdodD0iMjAiIHg9IjQ2LjUiIHk9IjQwIiBmaWxsPSIjRTlFOUU5IiByeD0iNSIgcnk9IjUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAgLTMwKSIvPjxyZWN0IHdpZHRoPSI3IiBoZWlnaHQ9IjIwIiB4PSI0Ni41IiB5PSI0MCIgZmlsbD0iIzk4OTY5NyIgcng9IjUiIHJ5PSI1IiB0cmFuc2Zvcm09InJvdGF0ZSgzMCAxMDUuOTggNjUpIi8+PHJlY3Qgd2lkdGg9IjciIGhlaWdodD0iMjAiIHg9IjQ2LjUiIHk9IjQwIiBmaWxsPSIjOUI5OTlBIiByeD0iNSIgcnk9IjUiIHRyYW5zZm9ybT0icm90YXRlKDYwIDc1Ljk4IDY1KSIvPjxyZWN0IHdpZHRoPSI3IiBoZWlnaHQ9IjIwIiB4PSI0Ni41IiB5PSI0MCIgZmlsbD0iI0EzQTFBMiIgcng9IjUiIHJ5PSI1IiB0cmFuc2Zvcm09InJvdGF0ZSg5MCA2NSA2NSkiLz48cmVjdCB3aWR0aD0iNyIgaGVpZ2h0PSIyMCIgeD0iNDYuNSIgeT0iNDAiIGZpbGw9IiNBQkE5QUEiIHJ4PSI1IiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoMTIwIDU4LjY2IDY1KSIvPjxyZWN0IHdpZHRoPSI3IiBoZWlnaHQ9IjIwIiB4PSI0Ni41IiB5PSI0MCIgZmlsbD0iI0IyQjJCMiIgcng9IjUiIHJ5PSI1IiB0cmFuc2Zvcm09InJvdGF0ZSgxNTAgNTQuMDIgNjUpIi8+PHJlY3Qgd2lkdGg9IjciIGhlaWdodD0iMjAiIHg9IjQ2LjUiIHk9IjQwIiBmaWxsPSIjQkFCOEI5IiByeD0iNSIgcnk9IjUiIHRyYW5zZm9ybT0icm90YXRlKDE4MCA1MCA2NSkiLz48cmVjdCB3aWR0aD0iNyIgaGVpZ2h0PSIyMCIgeD0iNDYuNSIgeT0iNDAiIGZpbGw9IiNDMkMwQzEiIHJ4PSI1IiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoLTE1MCA0NS45OCA2NSkiLz48cmVjdCB3aWR0aD0iNyIgaGVpZ2h0PSIyMCIgeD0iNDYuNSIgeT0iNDAiIGZpbGw9IiNDQkNCQ0IiIHJ4PSI1IiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoLTEyMCA0MS4zNCA2NSkiLz48cmVjdCB3aWR0aD0iNyIgaGVpZ2h0PSIyMCIgeD0iNDYuNSIgeT0iNDAiIGZpbGw9IiNEMkQyRDIiIHJ4PSI1IiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoLTkwIDM1IDY1KSIvPjxyZWN0IHdpZHRoPSI3IiBoZWlnaHQ9IjIwIiB4PSI0Ni41IiB5PSI0MCIgZmlsbD0iI0RBREFEQSIgcng9IjUiIHJ5PSI1IiB0cmFuc2Zvcm09InJvdGF0ZSgtNjAgMjQuMDIgNjUpIi8+PHJlY3Qgd2lkdGg9IjciIGhlaWdodD0iMjAiIHg9IjQ2LjUiIHk9IjQwIiBmaWxsPSIjRTJFMkUyIiByeD0iNSIgcnk9IjUiIHRyYW5zZm9ybT0icm90YXRlKC0zMCAtNS45OCA2NSkiLz48L3N2Zz4=) no-repeat;
    background-size: 100%
}

.weui-loading.weui-loading_transparent {
    background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120' viewBox='0 0 100 100'%3E%3Cpath fill='none' d='M0 0h100v100H0z'/%3E%3Crect xmlns='http://www.w3.org/2000/svg' width='7' height='20' x='46.5' y='40' fill='rgba(255,255,255,.56)' rx='5' ry='5' transform='translate(0 -30)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='rgba(255,255,255,.5)' rx='5' ry='5' transform='rotate(30 105.98 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='rgba(255,255,255,.43)' rx='5' ry='5' transform='rotate(60 75.98 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='rgba(255,255,255,.38)' rx='5' ry='5' transform='rotate(90 65 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='rgba(255,255,255,.32)' rx='5' ry='5' transform='rotate(120 58.66 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='rgba(255,255,255,.28)' rx='5' ry='5' transform='rotate(150 54.02 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='rgba(255,255,255,.25)' rx='5' ry='5' transform='rotate(180 50 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='rgba(255,255,255,.2)' rx='5' ry='5' transform='rotate(-150 45.98 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='rgba(255,255,255,.17)' rx='5' ry='5' transform='rotate(-120 41.34 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='rgba(255,255,255,.14)' rx='5' ry='5' transform='rotate(-90 35 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='rgba(255,255,255,.1)' rx='5' ry='5' transform='rotate(-60 24.02 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='rgba(255,255,255,.03)' rx='5' ry='5' transform='rotate(-30 -5.98 65)'/%3E%3C/svg%3E")
}

@-webkit-keyframes a {
    0% {
        -webkit-transform: rotate(0deg);
        transform: rotate(0deg)
    }

    to {
        -webkit-transform: rotate(1turn);
        transform: rotate(1turn)
    }
}

@keyframes a {
    0% {
        -webkit-transform: rotate(0deg);
        transform: rotate(0deg)
    }

    to {
        -webkit-transform: rotate(1turn);
        transform: rotate(1turn)
    }
}

.weui-badge {
    display: inline-block;
    padding: .15em .4em;
    min-width: 8PX;
    border-radius: 18PX;
    background-color: #e64340;
    color: #fff;
    line-height: 1.2;
    text-align: center;
    font-size: 12PX;
    vertical-align: middle
}

.weui-badge_dot {
    padding: .4em;
    min-width: 0
}

.weui-loadmore {
    width: 65%;
    margin: 1.5em auto;
    line-height: 1.6em;
    font-size: 14PX;
    text-align: center
}

.weui-loadmore__tips {
    display: inline-block;
    vertical-align: middle
}

.weui-loadmore_line {
    border-top: 1PX solid #e5e5e5;
    margin-top: 2.4em
}

.weui-loadmore__tips_in-line {
    position: relative;
    top: -.9em;
    padding: 0 .55em;
    background-color: #fff;
    color: #999
}

.weui-loadmore__tips_in-dot {
    position: relative;
    padding: 0 .16em;
    width: 4PX;
    height: 1.6em
}

.weui-loadmore__tips_in-dot:before {
    content: " ";
    position: absolute;
    top: 50%;
    left: 50%;
    margin-top: -1PX;
    margin-left: -2PX;
    width: 4PX;
    height: 4PX;
    border-radius: 50%;
    background-color: #e5e5e5
}

.weui-panel {
    background-color: #fff;
    margin-top: 10PX;
    position: relative;
    overflow: hidden
}

.weui-panel:first-child {
    margin-top: 0
}

.weui-panel:before {
    top: 0;
    border-top: 1rpx solid #e5e5e5
}

.weui-panel:after,
.weui-panel:before {
    content: " ";
    position: absolute;
    left: 0;
    right: 0;
    height: 1PX;
    color: #e5e5e5
}

.weui-panel:after {
    bottom: 0;
    border-bottom: 1rpx solid #e5e5e5
}

.weui-panel__hd {
    padding: 14PX 15PX 10PX;
    color: #999;
    font-size: 13PX;
    position: relative
}

.weui-panel__hd:after {
    content: " ";
    position: absolute;
    left: 0;
    bottom: 0;
    right: 0;
    height: 1PX;
    border-bottom: 1rpx solid #e5e5e5;
    color: #e5e5e5;
    left: 15PX
}

.weui-media-box {
    padding: 15PX;
    position: relative
}

.weui-media-box:before {
    content: " ";
    position: absolute;
    left: 0;
    top: 0;
    right: 0;
    height: 1PX;
    border-top: 1rpx solid #e5e5e5;
    color: #e5e5e5;
    left: 15PX
}

.weui-media-box:first-child:before {
    display: none
}

.weui-media-box__title {
    font-weight: 400;
    font-size: 17PX;
    width: auto;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    word-wrap: normal;
    word-wrap: break-word;
    word-break: break-all
}

.weui-media-box__desc {
    color: #999;
    font-size: 13PX;
    line-height: 1.2;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2
}

.weui-media-box__info {
    margin-top: 15PX;
    padding-bottom: 5PX;
    font-size: 13PX;
    color: #cecece;
    line-height: 1em;
    list-style: none;
    overflow: hidden
}

.weui-media-box__info__meta {
    float: left;
    padding-right: 1em
}

.weui-media-box__info__meta_extra {
    padding-left: 1em;
    border-left: 1PX solid #cecece
}

.weui-media-box__title_in-text {
    margin-bottom: 8PX
}

.weui-media-box_appmsg {
    display: -webkit-box;
    display: -webkit-flex;
    display: flex;
    -webkit-box-align: center;
    -webkit-align-items: center;
    align-items: center
}

.weui-media-box__thumb {
    width: 100%;
    height: 100%;
    vertical-align: top
}

.weui-media-box__hd_in-appmsg {
    margin-right: .8em;
    width: 60PX;
    height: 60PX;
    line-height: 60PX;
    text-align: center
}

.weui-media-box__bd_in-appmsg {
    -webkit-box-flex: 1;
    -webkit-flex: 1;
    flex: 1;
    min-width: 0
}

.weui-media-box_small-appmsg {
    padding: 0
}

.weui-cells_in-small-appmsg {
    margin-top: 0
}

.weui-cells_in-small-appmsg:before {
    display: none
}

.weui-progress {
    display: -webkit-box;
    display: -webkit-flex;
    display: flex;
    -webkit-box-align: center;
    -webkit-align-items: center;
    align-items: center
}

.weui-progress__bar {
    -webkit-box-flex: 1;
    -webkit-flex: 1;
    flex: 1
}

.weui-progress__opr {
    margin-left: 15PX;
    font-size: 0
}

.weui-navbar {
    display: -webkit-box;
    display: -webkit-flex;
    display: flex;
    position: absolute;
    z-index: 500;
    top: 0;
    width: 100%;
    border-bottom: 1rpx solid #ccc
}

.weui-navbar__item {
    position: relative;
    display: block;
    -webkit-box-flex: 1;
    -webkit-flex: 1;
    flex: 1;
    padding: 13PX 0;
    text-align: center;
    font-size: 0
}

.weui-navbar__item.weui-bar__item_on {
    color: #1aad19
}

.weui-navbar__slider {
    position: absolute;
    content: " ";
    left: 0;
    bottom: 0;
    width: 6em;
    height: 3PX;
    background-color: #1aad19;
    -webkit-transition: -webkit-transform .3s;
    transition: -webkit-transform .3s;
    transition: transform .3s;
    transition: transform .3s, -webkit-transform .3s
}

.weui-navbar__title {
    display: inline-block;
    font-size: 15PX;
    max-width: 8em;
    width: auto;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    word-wrap: normal
}

.weui-tab {
    position: relative;
    height: 100%
}

.weui-tab__panel {
    box-sizing: border-box;
    height: 100%;
    padding-top: 50PX;
    overflow: auto;
    -webkit-overflow-scrolling: touch
}

.weui-search-bar {
    position: relative;
    padding: 8PX 10PX;
    display: -webkit-box;
    display: -webkit-flex;
    display: flex;
    box-sizing: border-box;
    background-color: #efeff4;
    border-top: 1rpx solid #d7d6dc;
    border-bottom: 1rpx solid #d7d6dc
}

.weui-icon-search {
    margin-right: 8PX;
    font-size: inherit
}

.weui-icon-search_in-box {
    position: absolute;
    left: 10PX;
    top: 7PX
}

.weui-search-bar__text {
    display: inline-block;
    font-size: 14PX;
    vertical-align: middle
}

.weui-search-bar__form {
    position: relative;
    -webkit-box-flex: 1;
    -webkit-flex: auto;
    flex: auto;
    border-radius: 5PX;
    background: #fff;
    border: 1rpx solid #e6e6ea
}

.weui-search-bar__box {
    position: relative;
    padding-left: 30PX;
    padding-right: 30PX;
    width: 100%;
    box-sizing: border-box;
    z-index: 1
}

.weui-search-bar__input {
    height: 28PX;
    line-height: 28PX;
    font-size: 14PX
}

.weui-icon-clear {
    position: absolute;
    top: 0;
    right: 0;
    padding: 7PX 8PX;
    font-size: 0
}

.weui-search-bar__label {
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    z-index: 2;
    border-radius: 3PX;
    text-align: center;
    color: #9b9b9b;
    background: #fff;
    line-height: 28PX
}

.weui-search-bar__cancel-btn {
    margin-left: 10PX;
    line-height: 28PX;
    color: #09bb07;
    white-space: nowrap
}

/* 自定义样式 */
// .debugger__float {
//     position: fixed;
//     bottom: 10rpx;
//     left: 10rpx;
//     z-index: 9999;
//     display: flex;
//     width: 88rpx;
//     height: 88rpx;
//     align-items: center;
//     justify-content: center;
//     color: #fff;
//     border-radius: 6PX;
//     background-color: #1aad19;
// }
// .debugger__panel {
//     position: fixed;
//     width: 100%;
//     height: 100%;
//     top: 0;
//     left: 0;
//     z-index: 9998;
//     overscroll-behavior: contain;
//     background-color: #f1f1f1;
//     font-family: -apple-system-font,Helvetica Neue,Helvetica,sans-serif;
// }
.debugger {
    background-color: #f1f1f1;
    font-family: -apple-system-font,Helvetica Neue,Helvetica,sans-serif;
}
.weui-article__h1--debugger {
    text-align: center;
    background-color: #fff;
}
.weui-cell__bd--param {
    position: relative;
    align-items: center;
}
.weui-cell__bd--param-input {
    display: inline-block;
    width: 45%
}
.weui-cell__bd--param-equal {
    display: inline-block;
    text-align:center;
    width: 10%;
}
.weui-cell__bd--param-remove {
    position: absolute;
    top: -20px;
    right: -30px;
    z-index: 1;
}
.icon-remove {
    position: absolute;
    top: 5px;
    right: 5px;
    z-index: 1;
}
.match-rule-input-box {
    margin-left: 28PX;
    margin-top: 10px;
    padding-top: 10px;
    padding-bottom: 10px;
    padding-left: 10px;
}
.disabled-state {
    color: #aaa;
    background-color: #eee;
}
</style>